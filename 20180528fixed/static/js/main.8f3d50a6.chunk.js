(this.webpackJsonpfleece=this.webpackJsonpfleece||[]).push([[0],{37:function(e,t,a){},45:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a(14),r=a.n(n),o=(a(36),a(37),a(4)),i=a(5),c=a(7),l=a(6),u=function e(){Object(o.a)(this,e)};u.URL_GITHUB_HOST="https://www.github.com",u.URL_BITBUCKET_HOST="https://www.bitbucket.org",u.siteName="Fleece",u.userName="flyher",u.userName2="99diary",u.headerMenu=[{id:1,value:"oldFleece",text:"Old Fleece",url:"/old/index.html"},{id:2,value:"fleece",text:"Fleece",url:"https://fleece.99diary.com/"},{id:3,value:"blog",text:"blog",url:"https://blog.99diary.com/"}],u.orgInfo={profile:{avator:"https://avatars3.githubusercontent.com/u/5570324?s=460&v=4",orgName:"Fleece",author:u.userName,describe:"Open source for public project",location:"xx,China",link:"https://blog.99diary.com/2021/03/02/the-refactor-for-fleece",mail:"admin#xxx.com"}},u.tabs=[{id:1,value:"".concat(u.userName,"@github"),text:"".concat(u.userName,"@github"),userName:u.userName,link:u.URL_GITHUB_HOST+"/"+u.userName,counter:0,private:!1,api:{profile:"https://api.github.com/users/{userName}",repos:"https://api.github.com/users/{userName}/repos?"},pinned:[{id:1,name:"sheep"},{id:2,name:"ant-colony"},{id:3,name:"fleece"},{id:4,name:"totoro"},{id:5,name:"zhihu-react-native"},{id:6,name:"ColorPicker"},{id:7,name:"BlogBackup163"},{id:8,name:"shumeipai"},{id:9,name:"FivePies"}],selected:!0},{id:2,value:"".concat(u.userName2,"@github"),text:"".concat(u.userName2,"@github"),userName:u.userName2,link:"".concat(u.URL_GITHUB_HOST,"/").concat(u.userName2),counter:0,private:!1,api:{profile:"https://api.github.com/users/{userName}",repos:"https://api.github.com/users/{userName}/repos?"},pinned:[{id:1,name:"page-diary365-react-native"},{id:2,name:"KittyBlog"},{id:3,name:"mdblog"}],selected:!1},{id:3,value:"bitbucket",text:"Bitbucket",userName:u.userName,link:"".concat(u.URL_BITBUCKET_HOST,"/").concat(u.userName),counter:0,private:!0,api:{repos:"https://api.bitbucket.org/2.0/repositories/{userName}"},selected:!1},{id:4,value:"local",text:"Local",link:u.URL_GITHUB_HOST+"/"+u.userName,counter:0,private:!0,selected:!1}];var h=a(78),d=a(77),p=a(1),b=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={title:u.siteName,entry:{menus:u.headerMenu}},s}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.showMsg("Mounting componentDidMount")}},{key:"componentDidUpdate",value:function(){this.showMsg("Updating componentDidUpdate")}},{key:"componentWillUnmount",value:function(){this.showMsg("Unmounting componentWillUnmount")}},{key:"componentDidCatch",value:function(){this.showMsg("Error Handling componentDidCatch")}},{key:"showMsg",value:function(e){console.log(e)}},{key:"render",value:function(){var e=this.state.entry.menus.map((function(e){return Object(p.jsx)(h.a.Link,{href:e.url,children:e.text},e.id)}));return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(d.a,{bg:"dark",variant:"dark",children:[Object(p.jsx)(d.a.Brand,{href:"#",children:this.state.title}),Object(p.jsx)(h.a,{className:"mr-auto",children:e})]})})}}]),a}(s.Component),j=(a(45),a(15)),m=a.n(j),f=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={start:"2017",end:"2018",support:u.orgInfo.profile.link},s}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.setState({end:m()().format("YYYY")})}},{key:"render",value:function(){return Object(p.jsx)("div",{className:"footer-component",children:Object(p.jsxs)("div",{className:"content-container",children:[Object(p.jsxs)("span",{className:"copyright",children:["\xa9 ",this.state.start,"-",this.state.end," By \xa0",Object(p.jsx)("a",{href:"https://www.github.com/flyher/fleece",children:"fleece"}),". All rights reserved."]}),Object(p.jsx)("span",{className:"logo"}),Object(p.jsx)("span",{className:"links",children:Object(p.jsx)("a",{href:this.state.support,children:"Support"})})]})})}}]),a}(s.Component),g=a(21),v=a.n(g),O=(a(65),a(66),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={star:s.props.children},s}return Object(i.a)(a,[{key:"render",value:function(){return Object(p.jsxs)("a",{className:"star-icon-component mr-3",href:this.state.star.stargazersUrl,target:"_blank",children:[Object(p.jsx)("svg",{"aria-label":"star",className:"octicon octicon-star",viewBox:"0 0 14 16",version:"1.1",width:"14",height:"16",role:"img",children:Object(p.jsx)("path",{fillRule:"evenodd",d:"M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"})}),this.state.star.stargazersCount]})}}]),a}(s.Component)),x=(a(67),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={forked:s.props.children},s}return Object(i.a)(a,[{key:"render",value:function(){return Object(p.jsxs)("a",{className:"forked-icon-component mr-3",href:this.state.forked.networkUrl,target:"_blank",children:[Object(p.jsx)("svg",{"aria-label":"fork",className:"octicon octicon-repo-forked",viewBox:"0 0 10 16",version:"1.1",width:"10",height:"16",role:"img",children:Object(p.jsx)("path",{fillRule:"evenodd",d:"M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"})}),this.state.forked.forksCount]})}}]),a}(s.Component)),N=(a(68),a(69),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return Object(p.jsxs)("span",{className:"repo-language-color mr-3",children:[Object(p.jsx)("span",{className:"language-color "+"".concat(this.props.children).toLowerCase().replace("++","__").replace("#","_")}),Object(p.jsx)("span",{className:"programming-language",children:this.props.children})]})}}]),a}(s.Component)),_=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={orgRepo:s.props.children},s}return Object(i.a)(a,[{key:"render",value:function(){var e=u.URL_GITHUB_HOST+"/"+this.state.orgRepo.full_name+"/stargazers",t=u.URL_GITHUB_HOST+"/"+this.state.orgRepo.full_name+"/network";return Object(p.jsxs)("div",{className:"org-repo-component py-4 border-bottom",children:[Object(p.jsxs)("div",{className:"title mb-1",children:[Object(p.jsx)("h5",{className:"name",children:Object(p.jsx)("a",{href:this.state.orgRepo.html_url,children:this.state.orgRepo.name})}),Object(p.jsx)("span",{className:"fork-from f6 text-gray",children:this.state.orgRepo.fork?"Forked from ":""})]}),Object(p.jsxs)("div",{className:"describe",children:[Object(p.jsx)("p",{className:"text-gray",children:this.state.orgRepo.description}),Object(p.jsx)("div",{})]}),Object(p.jsxs)("div",{className:"focus f6 text-gray mt-2",children:[Object(p.jsx)(N,{children:this.state.orgRepo.language}),Object(p.jsx)(O,{children:{stargazersUrl:e,stargazersCount:this.state.orgRepo.stargazers_count}}),Object(p.jsx)(x,{children:{networkUrl:t,forksCount:this.state.orgRepo.forks_count}}),Object(p.jsxs)("span",{children:["last update: ","".concat(this.state.orgRepo.updated_at).substr(0,10)]})]})]})}}]),a}(s.Component),k=(a(70),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={orgInfo:s.props.children},s}return Object(i.a)(a,[{key:"render",value:function(){return Object(p.jsx)("div",{className:"org-head content-container",children:Object(p.jsx)("div",{className:"container"})})}}]),a}(s.Component)),y=(a(71),a(72),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={tab:s.props.children},s}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return Object(p.jsxs)("a",{className:"tab-component"+("true"=="".concat(this.state.tab.selected)?" selected":""),title:this.state.tab.link,onClick:function(){return e.props.onTabSwitch()},children:[Object(p.jsx)("svg",{className:"octicon octicon-repo",viewBox:"0 0 12 16",version:"1.1",width:"12",height:"16","aria-hidden":"true",children:Object(p.jsx)("path",{fillRule:"evenodd",d:"M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"})}),this.state.tab.text,Object(p.jsx)("span",{className:"counter",children:this.state.tab.counter})]})}}]),a}(s.Component)),S=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e))._onTabSwitch=function(e){var t=s.state.tabs;t.forEach((function(t){t.selected=!1,t.id===e.id&&(t.selected=!0)})),s.setState({tabs:t}),s.props._onParentReLoad(e)},s.state={tabs:s.props.children},s}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.state.tabs.map((function(t){return Object(p.jsx)(y,{children:t,onTabSwitch:e._onTabSwitch.bind(e,t)},t.id)}));return Object(p.jsx)("div",{className:"tabs-component content-container",children:t})}}]),a}(s.Component),U=(a(73),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={pinnedRepo:s.props.children},s}return Object(i.a)(a,[{key:"render",value:function(){var e=u.URL_GITHUB_HOST+"/"+this.state.pinnedRepo.full_name+"/stargazers",t=u.URL_GITHUB_HOST+"/"+this.state.pinnedRepo.full_name+"/network";return Object(p.jsxs)("div",{className:"pinned-repo-component p-3 ",children:[Object(p.jsx)("span",{className:"name",children:Object(p.jsx)("a",{href:this.state.pinnedRepo.html_url,className:"text-bold",children:this.state.pinnedRepo.name})}),Object(p.jsx)("p",{className:"describe pinned-repo-desc",children:this.state.pinnedRepo.description}),Object(p.jsxs)("p",{className:"focus f6 text-gray",children:[Object(p.jsx)(N,{children:this.state.pinnedRepo.language}),Object(p.jsx)(O,{children:{stargazersUrl:e,stargazersCount:this.state.pinnedRepo.stargazers_count}}),Object(p.jsx)(x,{children:{networkUrl:t,forksCount:this.state.pinnedRepo.forks_count}})]})]})}}]),a}(s.Component));var R=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={userName:u.userName,repoUrl:"".concat(u.userName,"@github"),private:!1,api:{profile:"https://api.github.com/users/{#userName}",repos:"https://api.github.com/users/{#userName}/repos?"},entry:{profile:{},public_repos:0,public_gists:0,followers:0,following:0,pageCount:0,repos:[],pinned_repos:[]},status:{needUpdate:!0,isLoading:!0},org:{orgInfo:u.orgInfo,tabs:u.tabs},test:{p1:1,p2:2,p3:3}},s}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this._readStorage()}},{key:"_loadProfile",value:function(){var e=this;this.state.private||v()({method:"get",url:this.state.api.profile.replace("{#userName}",this.state.userName)}).then((function(t){200===t.status&&e.setState({entry:Object.assign({},e.state.entry,{profile:t.data,public_repos:t.data.public_repos,public_gists:t.data.public_gists,followers:t.data.followers,following:t.data.following,pageCount:parseInt((t.data.public_repos/30).toString())+(t.data.public_repos%30>0?1:0)})},(function(){e._loadRepos()}))}))}},{key:"_loadRepos",value:function(){for(var e=this,t=this.state.entry.pageCount,a=[],s=1;s<=t;s++)a.push({id:s,pageNo:s,url:this.state.api.repos.replace("{#userName}",this.state.userName)+"sort=updated&direction=desc&page="+s});var n=0,r=[];a.forEach((function(a){v()({method:"get",url:a.url}).then((function(t){t.data.map((function(t){t.fork||t.owner.login!==e.state.userName||r.push(t)}))})).then((function(){++n===t&&(e.setState({entry:Object.assign({},e.state.entry,{repos:r})}),e._initData(),e._saveStorage())}))}))}},{key:"_readStorage",value:function(){var e=this;console.log("1");var t=localStorage[this.state.repoUrl],a=localStorage.cacheTabs;if(null!==a&&void 0!==a){var s=JSON.parse(a);this.setState({org:Object.assign({},this.state.org,{tabs:s})})}if(null!==t&&void 0!==t){var n=JSON.parse(t);j.utc().valueOf()/1e3-n.status.updateDate>86400?(console.log("read from remote"),this.setState({status:Object.assign({},this.state.status,{needUpdate:!0})},(function(){e._loadProfile()}))):(console.log("read from localstorage"),this.setState({entry:n.entry}),this.setState({status:Object.assign({},this.state.status,{needUpdate:!1})},(function(){e._initData()})),this._finishLoading())}else this.setState({status:Object.assign({},this.state.status,{needUpdate:!0})},(function(){e._loadProfile()}))}},{key:"_saveStorage",value:function(){localStorage[this.state.repoUrl]=JSON.stringify({entry:this.state.entry,status:{updateDate:j.utc().valueOf()/1e3}}),localStorage.cacheTabs=JSON.stringify(this.state.org.tabs),this._finishLoading()}},{key:"_beginLoading",value:function(){console.log("2"),this.setState(Object.assign({},this.state.status,{isLoading:!0}))}},{key:"_finishLoading",value:function(){console.log("3"),this.setState({status:Object.assign({},this.state.status,{isLoading:!1})},(function(){}))}},{key:"_initData",value:function(){var e=this,t=[];u.tabs.forEach((function(a){a.selected=!1,a.value===e.state.repoUrl&&(t=a.pinned,a.selected=!0)}));var a=[];this.state.entry.repos.forEach((function(e,s){t.forEach((function(t){t.name===e.name&&a.push(e)}))}));var s=this.state.entry;s.pinned_repos=a,this.setState({entry:s});var n=this.state.entry.repos.length,r=this.state.org.tabs;r.forEach((function(t){t.value===e.state.repoUrl&&(t.counter=n)})),this.setState({org:Object.assign({},this.state.org,{tabs:r})})}},{key:"_onParentReLoad",value:function(e){var t=this;this._beginLoading(),this.setState({userName:e.userName,repoUrl:e.value,private:e.private},(function(){t._readStorage()}))}},{key:"render",value:function(){var e,t,a=this.state.status.isLoading,s=this.state.entry.pinned_repos.map((function(e){return Object(p.jsx)("li",{className:"border-gray-dark border rounded-1 mb-3",children:Object(p.jsx)(U,{children:e})},"pinned-repo"+e.node_id)})),n=this.state.entry.repos.sort((e="updated_at",t=void 0===(t=!1)||t?1:-1,function(a,s){return(a=a[e])<(s=s[e])?-1*t:a>s?1*t:0})).map((function(e){return Object(p.jsx)(_,{children:e},"org-repo-"+e.node_id)}));return a?Object(p.jsx)("div",{className:"fleece-component",children:Object(p.jsx)("div",{className:"loading"})}):this.state.private?Object(p.jsxs)("div",{className:"fleece-component",children:[Object(p.jsx)("div",{className:"org-head-component",children:Object(p.jsx)(k,{children:this.state.org.orgInfo})}),Object(p.jsx)("div",{className:"pagehead-tabs-component",children:Object(p.jsx)(S,{children:this.state.org.tabs,_onParentReLoad:this._onParentReLoad.bind(this)})}),Object(p.jsx)("div",{className:"pinned-repos-component",children:Object(p.jsx)("div",{className:"private content-container",children:"We cannot load private project."})})]}):Object(p.jsxs)("div",{className:"fleece-component",children:[Object(p.jsx)("div",{className:"org-head-component",children:Object(p.jsx)(k,{children:this.state.org.orgInfo})}),Object(p.jsx)("div",{className:"pagehead-tabs-component",children:Object(p.jsx)(S,{children:this.state.org.tabs,_onParentReLoad:this._onParentReLoad.bind(this)})}),Object(p.jsxs)("div",{className:"pinned-repos-component",children:[Object(p.jsx)("h5",{className:"content-container",children:s.length>0?"Pinned repositories":""}),Object(p.jsx)("ol",{className:"content-container",children:s})]}),Object(p.jsx)("div",{className:"org-repos-component content-container",children:n})]})}}]),a}(s.Component);r.a.render(Object(p.jsxs)("div",{className:"app",children:[Object(p.jsx)(b,{}),Object(p.jsx)(R,{}),Object(p.jsx)(f,{})]}),document.getElementById("root"))}},[[74,1,2]]]);
//# sourceMappingURL=main.8f3d50a6.chunk.js.map